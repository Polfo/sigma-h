<!--
  ~ This file is part of ActivityInfo.
  ~
  ~ ActivityInfo is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ ActivityInfo is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with ActivityInfo.  If not, see <http://www.gnu.org/licenses/>.
  ~
  ~ Copyright 2009 Alex Bertram and contributors.
  -->

<module>

    <!-- Inherit the core Web Toolkit stuff.                        -->
    <inherits name='com.google.gwt.user.User' />

    <!-- Inherit additional dependencies  -->
    <inherits name='com.google.gwt.inject.Inject' />
    <inherits name="com.google.gwt.i18n.I18N" />
    <inherits name='com.extjs.gxt.ui.GXT' />
    <inherits name="com.google.gwt.maps.GoogleMaps" />
    <inherits name="com.ebessette.maps.core.CoreMaps" />
    <inherits name="com.google.gwt.gears.Gears" />
    <inherits name="com.google.gwt.inject.Inject"/>
    <inherits name="com.extjs.gxt.charts.Chart"/>

    <!-- Include generated sources -->
    <source path='client'/>
    <source path='shared'/>

    <!-- Specify the app entry point class.                         -->
    <entry-point class='org.activityinfo.client.Application' />

    <!-- Enable other locales -->
    <!--<extend-property name="locale" values="en" />-->
    <extend-property name="locale" values="fr" />

    <!-- We basically want a pretty different version of the application when
         offline mode is enabled. This will be triggered by a cookie -->
    <define-property name="offline.mode" values="enabled,disabled" />
    <property-provider name="offline.mode">
    <![CDATA[
        return (document.cookie.indexOf("offline=enabled") != -1) ? "enabled" : "disabled";
    ]]>
    </property-provider>


    <!-- Configure rebinding for the Gears Data Context -->

    <replace-with class="org.activityinfo.client.offline.OfflineApplication">
        <when-type-is class="org.activityinfo.client.Application"/>
        <when-property-is name="offline.mode" value="enabled"/>
    </replace-with>

    <replace-with class="org.activityinfo.client.offline.ui.OfflineMenuDisabled">
        <when-type-is class="org.activityinfo.client.offline.ui.OfflineMenu"/>
        <when-property-is name="offline.mode" value="disabled"/>
    </replace-with>

    <!-- Configure rebinding for the Export Service -->

    <generate-with class="org.activityinfo.rebind.ExportServiceInterfaceProxyGenerator">
        <when-type-assignable class="org.activityinfo.shared.report.ExportService"/>
    </generate-with>

    <servlet path="/cmd" class="org.activityinfo.server.servlet.CommandServlet" />

    <!-- Custom Linker that generates Gears manifests -->
    <define-linker name="std" class="org.activityinfo.linker.ApplicationLinker" />


</module>
